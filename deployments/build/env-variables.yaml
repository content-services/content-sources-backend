# Environment variables organized by groups for content-sources-backend deployment
# This file contains all environment variables used across different deployments and jobs

common:
  # Core application settings
  - name: CLOWDER_ENABLED
    value: ${CLOWDER_ENABLED}
  - name: LOGGING_LEVEL
    value: ${{LOGGING_LEVEL}}
  - name: OPTIONS_EXTERNAL_URL
    value: ${OPTIONS_EXTERNAL_URL}
  - name: OPTIONS_ALWAYS_RUN_CRON_TASKS
    value: ${OPTIONS_ALWAYS_RUN_CRON_TASKS}
  - name: OPTIONS_ENABLE_NOTIFICATIONS
    value: ${OPTIONS_ENABLE_NOTIFICATIONS}
  - name: OPTIONS_FEATURE_FILTER
    value: ${OPTIONS_FEATURE_FILTER}
  - name: OPTIONS_ENTITLE_ALL
    value: ${OPTIONS_ENTITLE_ALL}
  - name: TASKING_WORKER_COUNT
    value: ${TASKING_WORKER_COUNT}
  - name: TASKING_POOL_LIMIT
    value: ${TASKING_POOL_LIMIT}

  # Certificates and secrets
  - name: RH_CDN_CERT_PAIR
    valueFrom:
      secretKeyRef:
        name: content-sources-certs
        key: cdn.redhat.com
  - name: SENTRY_DSN
    valueFrom:
      secretKeyRef:
        name: content-sources-glitchtip
        key: dsn
        optional: true

  # Pulp client settings
  - name: CLIENTS_PULP_SERVER
    value: ${{CLIENTS_PULP_SERVER}}
  - name: CLIENTS_PULP_CUSTOM_REPO_CONTENT_GUARDS
    value: ${CLIENTS_PULP_CUSTOM_REPO_CONTENT_GUARDS}
  - name: CLIENTS_PULP_GUARD_SUBJECT_DN
    value: ${{CLIENTS_PULP_GUARD_SUBJECT_DN}}
  - name: CLIENTS_PULP_DOWNLOAD_POLICY
    value: ${{CLIENTS_PULP_DOWNLOAD_POLICY}}
  - name: CLIENTS_PULP_USERNAME
    value: ${{CLIENTS_PULP_USERNAME}}
  - name: CLIENTS_PULP_PASSWORD
    valueFrom:
      secretKeyRef:
        name: pulp-content-sources-password
        key: password
        optional: true

  # RBAC settings
  - name: CLIENTS_RBAC_BASE_URL
    value: ${{CLIENTS_RBAC_BASE_URL}}

  # Feature flags
  - name: FEATURES_SNAPSHOTS_ENABLED
    value: ${FEATURES_SNAPSHOTS_ENABLED}
  - name: FEATURES_SNAPSHOTS_ACCOUNTS
    value: ${FEATURES_SNAPSHOTS_ACCOUNTS}
  - name: FEATURES_SNAPSHOTS_ORGANIZATIONS
    value: ${FEATURES_SNAPSHOTS_ORGANIZATIONS}
  - name: FEATURES_ADMIN_TASKS_ENABLED
    value: ${FEATURES_ADMIN_TASKS_ENABLED}
  - name: FEATURES_ADMIN_TASKS_ACCOUNTS
    value: ${FEATURES_ADMIN_TASKS_ACCOUNTS}
  - name: FEATURES_ADMIN_TASKS_ORGANIZATIONS
    value: ${FEATURES_ADMIN_TASKS_ORGANIZATIONS}

  # Candlepin settings
  - name: CLIENTS_CANDLEPIN_SERVER
    value: ${CLIENTS_CANDLEPIN_SERVER}
  - name: CLIENTS_CANDLEPIN_CLIENT_CERT
    valueFrom:
      secretKeyRef:
        name: content-sources-candlepin
        key: cert
        optional: true
  - name: CLIENTS_CANDLEPIN_CLIENT_KEY
    valueFrom:
      secretKeyRef:
        name: content-sources-candlepin
        key: key
        optional: true
  - name: CLIENTS_CANDLEPIN_CA_CERT
    valueFrom:
      secretKeyRef:
        name: content-sources-candlepin
        key: ca
        optional: true

  # Feature service settings
  - name: CLIENTS_FEATURE_SERVICE_SERVER
    value: ${CLIENTS_FEATURE_SERVICE_SERVER}
  - name: CLIENTS_FEATURE_SERVICE_CLIENT_CERT
    valueFrom:
      secretKeyRef:
        name: content-sources-candlepin
        key: cert
        optional: true
  - name: CLIENTS_FEATURE_SERVICE_CLIENT_KEY
    valueFrom:
      secretKeyRef:
        name: content-sources-candlepin
        key: key
        optional: true

  # Roadmap settings
  - name: CLIENTS_ROADMAP_SERVER
    value: ${CLIENTS_ROADMAP_SERVER}

service_specific:
  # Service-specific variables (for API service)
  - name: OPTIONS_REPOSITORY_IMPORT_FILTER
    value: ${OPTIONS_REPOSITORY_IMPORT_FILTER}
  - name: CLIENTS_PULP_DATABASE_HOST
    valueFrom:
      secretKeyRef:
        name: pulp-db
        key: db.host
        optional: false
  - name: CLIENTS_PULP_DATABASE_PORT
    valueFrom:
      secretKeyRef:
        name: pulp-db
        key: db.port
        optional: false
  - name: CLIENTS_PULP_DATABASE_USER
    valueFrom:
      secretKeyRef:
        name: pulp-db
        key: db.user
        optional: false
  - name: CLIENTS_PULP_DATABASE_PASSWORD
    valueFrom:
      secretKeyRef:
        name: pulp-db
        key: db.password
        optional: false
  - name: CLIENTS_PULP_DATABASE_NAME
    valueFrom:
      secretKeyRef:
        name: pulp-db
        key: db.name
        optional: false

job_specific:
  # Job-specific variables for different cron jobs
  process_repos:
    - name: OPTIONS_SNAPSHOT_RETAIN_DAYS_LIMIT
      value: ${OPTIONS_SNAPSHOT_RETAIN_DAYS_LIMIT}
  
  transform_pulp_logs:
    - name: CLIENTS_PULP_LOG_PARSER_CLOUDWATCH_GROUP
      value: ${CLIENTS_PULP_LOG_PARSER_CLOUDWATCH_GROUP}
    - name: CLIENTS_PULP_LOG_PARSER_CLOUDWATCH_REGION
      value: ${CLIENTS_PULP_LOG_PARSER_CLOUDWATCH_REGION}
    - name: CLIENTS_PULP_LOG_PARSER_S3_FILE_PREFIX
      value: ${CLIENTS_PULP_LOG_PARSER_S3_FILE_PREFIX}
    - name: CLIENTS_PULP_LOG_PARSER_CLOUDWATCH_KEY
      valueFrom:
        secretKeyRef:
          name: content-sources-appsre-log-access-pulp
          key: aws_access_key_id
          optional: true
    - name: CLIENTS_PULP_LOG_PARSER_CLOUDWATCH_SECRET
      valueFrom:
        secretKeyRef:
          name: content-sources-appsre-log-access-pulp
          key: aws_secret_access_key
          optional: true
    - name: CLIENTS_PULP_LOG_PARSER_S3_NAME
      valueFrom:
        secretKeyRef:
          name: ${FLOORIST_BUCKET_SECRET_NAME}
          key: bucket
          optional: true
    - name: CLIENTS_PULP_LOG_PARSER_S3_SECRET_KEY
      valueFrom:
        secretKeyRef:
          name: ${FLOORIST_BUCKET_SECRET_NAME}
          key: aws_secret_access_key
    - name: CLIENTS_PULP_LOG_PARSER_S3_ACCESS_KEY
      valueFrom:
        secretKeyRef:
          name: ${FLOORIST_BUCKET_SECRET_NAME}
          key: aws_access_key_id
    - name: CLIENTS_PULP_LOG_PARSER_S3_REGION
      valueFrom:
        secretKeyRef:
          name: ${FLOORIST_BUCKET_SECRET_NAME}
          key: aws_region 